#include<iostream>
#include<cstring>
#include<string>
#include<sstream>
#include<ctime>//ii
#include<cstdlib>

//wahaha

using namespace std;

#define MOB 10
#define N   12

int flag=(N-2)*(N-2)-MOB,go=1;
void csh1(int a[][N]);
void show(int a[][N],int b[][N]);
void att(int a[][N],int b[][N],int x,int y);
void flash(int a[][N],int b[][N],int x,int y);

int main(){
	int a[N][N],b[N][N];
	memset(a,0,sizeof(a));
	memset(b,0,sizeof(b));
	csh1(a);
	system("color F1"); 
	while(go){
		int x,y;
		string x1,y1; 
		show(a,b);
		cout<<"请选择打开的位置\n";
		cout<<"x坐标为？\n";	 
		cin>>x1;
		system("cls");
		show(a,b);
		cout<<"y坐标为？\n"; 
		cin>>y1;
		stringstream ss;
		ss<<x1;
		ss>>x;
		ss.clear();
		ss.str("");
		ss<<y1;
		ss>>y;
		ss.clear();
		ss.str("");
		while(x<1||x>N-2||y<1||y>N-2||b[x][y]==1){
			system("cls");
			show(a,b);
			cout<<"坐标错误，请选择打开的位置\n";
			cout<<"x坐标为？\n";	 
			cin>>x1;
			system("cls");
			show(a,b);
			cout<<"y坐标为？\n"; 
			cin>>y1;
			ss<<x1;
			ss>>x;
			ss.clear();
			ss.str("");
			ss<<y1;
			ss>>y;
			ss.clear();
			ss.str("");	
		}                                                          
		att(a,b,x,y);
		system("cls");		
	}
	show(a,b);
	if(!flag)
		cout<<"you are win\n";
	else
		cout<<"you are lose\n";
	cout<<"按任意键结束游戏\n";
	cin.get();
	cin.get();  
    return 0;
}

void csh1(int a[][N]){
	srand(time(0));
	int x,y;
	for(int k=0;k<MOB;k++){
		x=rand()%(N-2)+1;
		y=rand()%(N-2)+1;
		if(a[x][y]==-1){
		k--;
		continue;
		}
		a[x][y]=-1;
		int i,j;
		for(i=x-1;i<=x+1;i++)
			for(j=y-1;j<=y+1;j++)
				if(a[i][j]!=-1)
				  	a[i][j]++;
	}
}

void show(int a[][N],int b[][N]){
	int k;
	cout<<"╔";
	for(k=1;k<=N-2;k++)
		cout<<"═";
	cout<<"╗\n";
	for(int i=1;i<=N-2;i++){
		cout<<"║";
		for(int j=1;j<=N-2;j++)
			if(b[i][j]==1){
				if(a[i][j]==-1)
					cout<<"X ";
				else if(a[i][j]==0)                                            
					cout<<"  ";
				else
					cout<<a[i][j]<<" ";
				}
			else
				cout<<"? ";
		cout<<"║\n";
	}
	cout<<"╚";
	for(k=1;k<=N-2;k++)
		cout<<"═";
	cout<<"╝\n";	
}

void att(int a[][N],int b[][N],int x,int y){	 
	 if(a[x][y]==-1){
		for(int i=1;i<=N-2;i++)
			for(int j=1;j<=N-2;j++)
				b[i][j]=1;
				go=0;
		}
	 else
	 	flash(a,b,x,y);
} 

void flash(int a[][N],int b[][N],int x,int y){
	 b[x][y]=1;
	 flag--;
	 if(x-1>0&&x-1<N-1&&b[x-1][y]==0)
	 	if(a[x-1][y]==0)
	 		flash(a,b,x-1,y);
	 	else if(a[x-1][y]>0){
	 		b[x-1][y]=1;
	 		flag--;
	 	}
	 if(x+1>0&&x+1<N-1&&b[x+1][y]==0)
	 	if(a[x+1][y]==0)
	 		flash(a,b,x+1,y);
	 	else if(a[x+1][y]>0){
	 		b[x+1][y]=1;
	 		flag--; 
	 	}
	 if(y-1>0&&y-1<N-1&&b[x][y-1]==0)
	 	if(a[x][y-1]==0)
	 		flash(a,b,x,y-1);
	 	else if(a[x][y-1]>0){
	 		b[x][y-1]=1;
	 		flag--; 
	 	}
	 if(y+1>0&&y+1<N-1&&b[x][y+1]==0)
	 	if(a[x][y+1]==0)
	 		flash(a,b,x,y+1);
	 	else if(a[x][y+1]>0){
	 		b[x][y+1]=1;
			flag--; 
	 	}	
}	

//good